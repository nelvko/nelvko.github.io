
      
      
      
    
      
      
      
    
      
      
      
    
      
      
      
    [{"authors":null,"categories":null,"content":"Jenkins \u0026amp; uniapp の build 基于 HBuilderX 软件提取的打包命令编写的脚本，稳定、可靠，可用于生产环境。\n网上大部分此类教程是根据uniapp官网提供的HBuilderX 工程转换为 vue-cli 工程进行的，据了解其有弊端、集成Jenkins稍显啰嗦且我没最终成功过，故出此教程备忘。\n1.文件准备 HBuilderX安装目录下的plugins目录下的\nuniapp-cli compile-node-sass https://github.com/sass/node-sass/releases\n服务器执行以下命令根据打印的版本号去下载对应的版本\nnode -p process.versions | grep modules 解压后重命名为 binding.node，并移动到指定目录\n# 末尾目录名对应版本号，这里以93为例 mkdir -p ./compile-node-sass/node_modules/node-sass-\tchina/vendor/linux-x64-93 mv ./binding.node ./compile-node-sass/node_modules/node-sass-\tchina/vendor/linux-x64-93/ 将以上三个目录上传至/root/uniapp-compile\n2.打包脚本 cd uniapp-cli PROJECT_PATH=xxx export UNI_INPUT_DIR=$PROJECT_PATH export UNI_OUTPUT_DIR=$PROJECT_PATH/unpackage/dist/build/h5 export NODE_ENV=production node --max-old-space-size=2048 ./bin/uniapp-cli.js 3. Jenkins 流水线脚本 pipeline { agent any tools {nodejs \u0026#34;nodejs\u0026#34;} environment{ COMPILE_PATH = \u0026#34;/root/uniapp-compile\u0026#34; WEBSITE_DIR = \u0026#34;mojospy.love\u0026#34; } stages { stage(\u0026#34;拉代码\u0026#34;) { steps{ sh\u0026#39;\u0026#39;\u0026#39; rm -rf ./* \u0026#39;\u0026#39;\u0026#39; checkout scmGit(branches: [[name: \u0026#39;*/dev\u0026#39;]], extensions: [], userRemoteConfigs: [[credentialsId: \u0026#39;placeholder\u0026#39;, url: \u0026#39;placeholder\u0026#39;]]) } } stage(\u0026#34;打包\u0026#34;) { steps{ sh\u0026#39;\u0026#39;\u0026#39; PROJECT_DIR=`pwd` cd $COMPILE_PATH/uniapp-cli PROJECT_PATH=$PROJECT_DIR export UNI_INPUT_DIR=$PROJECT_PATH export UNI_OUTPUT_DIR=$PROJECT_PATH/unpackage/dist/build/h5 export NODE_ENV=production node --max-old-space-size=2048 ./bin/uniapp-cli.js \u0026#39;\u0026#39;\u0026#39; } } stage(\u0026#34;传输\u0026#34;){ steps { sshPublisher(publishers: [sshPublisherDesc(configName: \u0026#39;placeholder\u0026#39;, transfers: [sshTransfer(cleanRemote: false, excludes: \u0026#39;\u0026#39;, execCommand: \u0026#39;\u0026#39;, execTimeout: 120000, flatten: false, makeEmptyDirs: false, noDefaultExcludes: false, patternSeparator: \u0026#39;[, ]+\u0026#39;, remoteDirectory: \u0026#34;$WEBSITE_DIR\u0026#34;, remoteDirectorySDF: false, removePrefix: \u0026#39;unpackage/dist/build/h5\u0026#39;, sourceFiles: \u0026#39;unpackage/dist/build/h5/**\u0026#39;)], usePromotionTimestamp: false, useWorkspaceInPromotion: false, verbose: false)]) } } } } ","date":1724667480,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1727658868,"objectID":"a4e076a771f9242152f9099cc430e669","permalink":"https://nelvko.cn/post/jenkins--uniapp-%E3%81%AE-build/","publishdate":"2024-08-26T18:18:00+08:00","relpermalink":"/post/jenkins--uniapp-%E3%81%AE-build/","section":"post","summary":"Jenkins \u0026 uniapp の build","tags":["Linux","Jenkins","uniapp"],"title":"uniapp 项目集成 Jenkins 实现自动化部署","type":"post"},{"authors":null,"categories":null,"content":"子模块用法 添加 git submodule add \u0026lt;url\u0026gt; [path] 删除 亦或切换远程库地址\nrm -rf \u0026lt;path\u0026gt; vi .gitmodules vi .git/config rm .git/modules/* git add . git rm --cached \u0026lt;path\u0026gt; ","date":1712251469,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1727658868,"objectID":"00ab72b293428181889fe73649eba060","permalink":"https://nelvko.cn/post/git-submodule/","publishdate":"2024-04-05T01:24:29+08:00","relpermalink":"/post/git-submodule/","section":"post","summary":"git submodule","tags":["Git"],"title":"Git 子模块","type":"post"},{"authors":null,"categories":null,"content":"更新 Git 2.x 版本 yum -y remove -y git yum -y remove -y git-* yum -y install https://packages.endpointdev.com/rhel/7/os/x86_64/endpoint-repo.x86_64.rpm yum install -y git Git默认开启了 SSL 证书验证功能，关闭 SSL 证书验证：\ngit config --global http.sslVerify false ","date":1712172740,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1727658868,"objectID":"7667c5c442ca2e8e8fef9cc966642441","permalink":"https://nelvko.cn/post/centos-memo/","publishdate":"2024-04-04T03:32:20+08:00","relpermalink":"/post/centos-memo/","section":"post","summary":"centos 系统备忘","tags":["Linux"],"title":"CentOS Memo","type":"post"}]